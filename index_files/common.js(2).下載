/* 
 * BNSAPP  Bnsサイト全体で使用する機能
 * 
 */
var BNSAPP;
(function($){
    $(function(){
        BNSAPP = {
            
            popOpen: function(html) { //ポップアップ用script htmlにはstringのhtmlデータ
                
                var winH, winW, contentH, contentW, distH, distW,
                    bg = "<div id='popBg'></div>",
                    html = $("<div id='popWindow'><div id='popWindowNull1'><div class='content'>" + html +"</div></div></div>");
                
                html.css({display: "none"});
                $(document.body).append(bg);
                $(document.body).append(html);
                
                winH = $(window).height();
                winW = $(window).width();
                contentH = html.height();
                contentW = html.width();
                distH = (winH - contentH) / 2;
                distW = (winW - contentW) / 2;
                html.css({top: distH + "px", left: distW + "px" }).fadeIn(500);
                return html;
            },
            
            popClose: function(html) { //popOpenで表示したポップアップを消す
                
                $("#popBg").remove();
                if (!html) {
                    $("#popWindow").remove();
                } else {
                    html.remove();
                }
            }
        }
    });
}(jQuery));

/* 
 * MENU
 * 
 * hover時に.currentに.hideを指定。ロールオーバー中のaのnextのulには.showを指定
 */
(function($){
    $(function(){
        var menu = $("#mainMenu"),
            li = $("> ul > li", menu).not(".current"),
            current = $("> ul > .current", menu);
            
        li.bind({
            "mouseenter": function(){
                current.addClass("hide");
                $(this).addClass("show");
            },
            "mouseleave": function(){
                current.removeClass("hide");
                $(this).removeClass("show");
            }
        });
    });
}(jQuery));

/* 
 * Class Forumプルダウン
 */
(function($){
    $(function(){
        var select = $("#bodyHead .pageTitle .select");
        var hideSelect = function(that){
            if (that[0] !== select[0]) {
                select.removeClass("show");
            }
        };
        select.bind({
            "click": function(event){
                if ($(this).hasClass("show")) {
                    $(this).removeClass("show");
                    $(document).unbind("click", hideSelect);
                } else {
                    $(this).addClass("show");
                    event.stopPropagation();
                    $(document).bind("click", hideSelect);
                }
            }
        });
    });
}(jQuery));

(function($){

    $(function(){
        //メニュー調整

        var bindFlag =  0,
            $header =   $("pwHeader"),
            $gnb =      $(".ncGnb"),
            //$mainMenuArea = $("#mainMenuArea"),
            //$mainMenuList = $(".main > li", $mainMenuArea),
            //$subMenuList,
            //$logo =     $(".logo", $header),
            nowYPos =   $(window).scrollTop();

        //メニュー横位置調整(fixed対応)
        var winLeftScroll = function () {
            function setMenuLeft() {
                $header.css("left",-($(window).scrollLeft()) + "px");
            }
            if($(window).width() < 1170){
                if(bindFlag === 0){
                    $(window).bind("scroll.hoge1",setMenuLeft);
                    bindFlag = 1;
                }
            }else{
                if(bindFlag === 1){
                    $(window).unbind("scroll.hoge1");
                    bindFlag = 0;
                }
                $header.css("left","auto");
            }
        }

        $(window).resize(function(){
            winLeftScroll();
        });

        winLeftScroll();

        //メニュー上げ下げ　class操作のみ　アニメはcss3
        var menuFlag = 1;
        var isIE8 = (function(){
                return $("html").hasClass("lt-ie9");
            }());

        if (!isIE8) {
            var winScroll = function() {
                var top = $(window).scrollTop();
                diffYPos = nowYPos - top;
                nowYPos = top;

				if($('body').height() - $(window).height() - top <1) return;

                if (diffYPos < 0 && top > 0) { //下方向
                    if (menuFlag === 0) {
                        return;
                    }

                    chgMainMenu("small", function(){});

                } else { //上方向
                    if (menuFlag === 1) {
                        return;
                    }

                    chgMainMenu("big", function(){});

                }
            }


            var chgMainMenu = function(str) {
                if (str === "big") {
                    $(".ncGnb").removeClass("small");
                    menuFlag = 1;

                } else { //small
                    $(".ncGnb").addClass("small");
                    menuFlag = 0;

                }
            }

            $(window).scroll(function(){
                winScroll();
            });
        }
    });
}(jQuery));

//Analytics
(function($){
    $(function(){
        $('body').append(
            '<script type="text/javascript">\
            /* <![CDATA[ */\
            var google_conversion_id = 964862149;\
            var google_custom_params = window.google_tag_params;\
            var google_remarketing_only = true;\
            /* ]]> */\
            </script>\
            <script type="text/javascript" src="//www.googleadservices.com/pagead/conversion.js">\
            </script>\
            <noscript>\
            <div style="display:inline;">\
            <img height="1" width="1" style="border-style:none;" alt="" src="//googleads.g.doubleclick.net/pagead/viewthroughconversion/964862149/?value=0&amp;guid=ON&amp;script=0"/>\
            </div>\
            </noscript>'
        );
    });
}(jQuery));

//IE png filter
(function($){
    $(function() {
        if(navigator.userAgent.indexOf("MSIE") != -1) {
            $('img').each(function() {
                if($(this).attr('src').indexOf('.png') != -1) {
                    $(this).css({
                        'filter': 'progid:DXImageTransform.Microsoft.AlphaImageLoader(src="' +
                        $(this).attr('src') +
                        '", sizingMethod="scale");'
                    });
                }
            });
        }
    });
}(jQuery));

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-52645843-2', 'auto');
ga('send', 'pageview');

// 14.10.21
// (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
// (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
// m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
// })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

// ga('create', 'UA-52645843-2', 'auto');
// ga('send', 'pageview');